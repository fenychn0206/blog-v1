---
title: ã€Œé¢˜è§£ã€ ç´ æ•°ç¯
date: 2024-06-27 21:25:16
tags:
 - ä¿¡æ¯ç«èµ›
 - OI
 - é¢˜è§£
 - C++
categories:
 - ä¿¡æ¯ç«èµ›OI
 - é¢˜è§£
mathjax: true
---

## å‰è¨€ï¼š

åœ¨å­¦æ ¡ä¿¡æ¯é˜Ÿè®­ç»ƒçš„æ—¶å€™å¸ƒç½®äº†è¿™ä¸€é“é¢˜ç›®ï¼Œä½†æ˜¯åªæ±‚ä¸€æ¬¡ã€‚ç„¶åä¸Šæ´›è°·å‘ç°UVAé¢˜åº“æ±‚å¤šæ¬¡ï¼Œå› ä¸ºæ–¹æ³•ä¸€æ ·åªéœ€åµŒå¥—ï¼Œæ‰€ä»¥å°±åšäº†ä¸€ä¸‹ï¼ˆæ²¡æœ‰è´¦å·æäº¤ä¸äº†=m=ï¼‰

## ä¿¡æ¯é˜ŸåŸé¢˜

![åŸé¢˜å›¾ç‰‡](https://cdn.jsdelivr.net/gh/FrederickBun/upyun-rhimgcdn@img/upload/202406272146771.png)

## 1.é¢˜ç›®åˆ†æ

é¢˜ç›®è¦æ±‚å°†æ•´æ•° $1$ åˆ° $n$ ç»„æˆä¸€ä¸ªç¯ï¼Œä½¿å¾—ç›¸é‚»çš„ä¸¤ä¸ªæ•´æ•°ä¹‹å’Œå‡ä¸ºç´ æ•°ã€‚

æˆ‘ä»¬éœ€è¦æ‰¾åˆ°æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ç´ æ•°ç¯ï¼Œå¹¶æŒ‰ç…§è¦æ±‚è¾“å‡ºã€‚

ç”±äº $n$ çš„å€¼ä¸è¶…è¿‡ $16$ ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å›æº¯æ³•æ¥å°è¯•æ‰€æœ‰å¯èƒ½çš„ç»„åˆã€‚

## 2.åšé¢˜æ€è·¯

åˆ¤æ–­å½“å‰å–å‡ºçš„æ•°å­—æ˜¯å¦å’Œå‰ä¸€ä¸ªç»„æˆç´ æ•°ï¼Œè¿™ä¸€æ­¥å¯ä»¥ç”¨ä¸€ä¸ª `check`å‡½æ•°æ¥è§£å†³ï¼ˆnumçš„å€¼ä¸ºä¸¤ä¸ªæ•°å­—çš„å’Œï¼‰

```cpp
bool check(int num)
{
    if (num < 2)
    {
        return false;
    }
    for (int i = 2; i * i <= num; i++)
    {
        if (num % i == 0)
        {
            return false;
        }
    }
    return true;
}
```



åœ¨åˆ›å»ºä¸€ä¸ª `back` å‡½æ•°ç”¨äºå›æº¯ï¼š

```cpp
void back(int cur)  // cur è¡¨ç¤ºå½“å‰ä½ç½®
{
    if (cur == n)  // æ£€æŸ¥æœ€åä¸€ä¸ªæ•°å­—å’Œç¬¬ä¸€ä¸ªæ•°å­—ä¹‹å’Œæ˜¯å¦ä¸ºç´ æ•°
    {
        if (check(arr[0] + arr[n - 1]))
        {
            for (int i = 0; i < n; i++)
            {
                cout << arr[i] << " ";
            }
            cout << endl;
        }
        return;
    }
    for (int i = 2; i <= n; i++)
    {
        if (!vis[i] && check(arr[cur - 1] + i))
        {
            vis[i] = true;
            arr[cur] = i;
            back(cur + 1);
            vis[i] = false;
        }
    }
}
```

åœ¨backå‡½æ•°ä¸­ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦å·²ç»æ”¾ç½®äº† $n$ ä¸ªæ•°å­—ã€‚å¦‚æœæ˜¯ï¼Œåˆ™æ£€æŸ¥æœ€åä¸€ä¸ªæ•°å­—å’Œç¬¬ä¸€ä¸ªæ•°å­—ä¹‹å’Œæ˜¯å¦ä¸ºç´ æ•°ã€‚å¦‚æœæ˜¯ç´ æ•°ï¼Œåˆ™è¾“å‡ºè¿™ä¸ªç¯ã€‚

ç„¶åï¼Œä»æ•°å­— $2$ åˆ° $n$ ä¾æ¬¡å°è¯•å°†æ¯ä¸ªæ•°å­—æ”¾åœ¨ç¯çš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚å¦‚æœè¯¥æ•°å­—æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ï¼Œå¹¶ä¸”ä¸å‰ä¸€ä¸ªæ•°å­—ä¹‹å’Œä¸ºç´ æ•°ï¼Œå°±å°†å…¶æ”¾åœ¨ç¯çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œå¹¶æ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼Œç„¶åç»§ç»­é€’å½’æ”¾ç½®ä¸‹ä¸€ä¸ªæ•°å­—ã€‚

å¦‚æœæ”¾ç½®è¿‡ç¨‹ä¸­å‡ºç°ç›¸é‚»ä¸¤ä¸ªæ•°å­—ä¹‹å’Œä¸æ˜¯ç´ æ•°çš„æƒ…å†µï¼Œå°±å›æº¯åˆ°ä¸Šä¸€ä¸ªæ•°å­—ï¼Œé‡æ–°é€‰æ‹©ä¸‹ä¸€ä¸ªæ•°å­—ã€‚

æœ€åæ˜¯ `main` å‡½æ•°ï¼Œåœ¨mainå‡½æ•°ä¸­ï¼Œè¯»å–è¾“å…¥çš„ $n$ ï¼Œåˆå§‹åŒ–æ ‡è®°æ•°ç»„å’Œç¯çš„ç¬¬ä¸€ä¸ªæ•°å­—ï¼Œç„¶åè°ƒç”¨ `back` å‡½æ•°ä»æ•°å­— $1$ å¼€å§‹å›æº¯ã€‚

## 3.å¤æ‚åº¦è®¡ç®—

æ—¶é—´å¤æ‚åº¦ï¼šç”±äºéœ€è¦å°è¯•æ‰€æœ‰å¯èƒ½çš„ç»„åˆï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(n!)$ ï¼Œå…¶ä¸­ n æ˜¯è¾“å…¥çš„æ•°å­—ä¸ªæ•°

ç©ºé—´å¤æ‚åº¦ï¼šä¸»è¦æ˜¯ä½¿ç”¨äº†æ ‡è®°æ•°ç»„å’Œç¯æ•°ç»„ï¼Œç©ºé—´å¤æ‚åº¦ä¸º $O(n)$ 

## 4.å®Œæ•´ä»£ç 

```cpp
#include <bits/stdc++.h>
using namespace std;

const int MAXN = 16;
int n;
int arr[MAXN];
bool vis[MAXN];

// åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºç´ æ•°
bool check(int num)
{
    if (num < 2)
    {
        return false;
    }
    for (int i = 2; i * i <= num; i++)
    {
        if (num % i == 0)
        {
            return false;
        }
    }
    return true;
}

// å›æº¯
// curè¡¨ç¤ºå½“å‰ä½ç½®
void back(int cur)
{
    if (cur == n)  // æ£€æŸ¥æœ€åä¸€ä¸ªæ•°å­—å’Œç¬¬ä¸€ä¸ªæ•°å­—ä¹‹å’Œæ˜¯å¦ä¸ºç´ æ•°
    {
        if (check(arr[0] + arr[n - 1]))
        {
            for (int i = 0; i < n; i++)
            {
                cout << arr[i] << " ";
            }
            cout << endl;
        }
        return;
    }
    for (int i = 2; i <= n; i++)
    {
        if (!vis[i] && check(arr[cur - 1] + i))
        {
            vis[i] = true;
            arr[cur] = i;
            back(cur + 1);
            vis[i] = false;
        }
    }
}

int main()
{
    cin >> n;
    memset(vis, false, sizeof(vis));
    vis[1] = true;
    arr[0] = 1;
    back(1);
    return 0;
}
```

## æ´›è°·UVAé¢˜åº“ç‰ˆ

å‰é¢ä¸æ˜¯è¯´äº†å—ï¼ŒUVAä¹Ÿæœ‰ä¸€ä¸ªç‰ˆæœ¬ï¼Œæ˜¯ç»™å‡ºå¤šä¸ªå€¼ï¼Œè¿™é‡Œç»™å‡ºé¢˜ç›®ï¼š

![æ´›è°·UVAé¢˜ç›®](https://cdn.jsdelivr.net/gh/FrederickBun/upyun-rhimgcdn@img/upload/202406272200565.png)

### æ ·ä¾‹ç»„

**INPUT #1**

```è¾“å…¥æ ·ä¾‹ 1
6
8
```

**OUTPUT #1**

```è¾“å‡ºæ ·ä¾‹1
Case 1:
1 4 3 2 5 6
1 6 5 2 3 4

Case 2:
1 2 3 8 5 6 7 4
1 2 5 8 3 4 7 6
1 4 7 6 5 8 3 2
1 6 7 4 3 8 5 2
```

å…¶å®å°±æ˜¯å¤šæ¬¡è¾“å…¥ï¼Œç”¨ `while` å¾ªç¯è§£å†³ï¼Œç»ˆæ­¢æ¡ä»¶ä¸º `n == EOF`ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·å†™ã€‚

```cpp
while(n != EOF)
    {
        cin >> n;
        memset(vis, false, sizeof(vis));
        vis[1] = true;
        arr[0] = 1;
        back(1);
    }
```

ç°åœ¨æ˜¯æŠŠåˆšæ‰ä¿¡æ¯é˜Ÿç‰ˆæœ¬çš„è¾“å…¥å’Œæ“ä½œå¥—åœ¨äº†å¾ªç¯é‡Œï¼Œ~~è¿™å°±å®Œäº†~~ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿ

å…¶å®æ²¡å®Œï¼Œé¢˜ç›®ä¸­è¯´è¦åœ¨ç¬¬ `i` è¡Œæ·»åŠ ä¸Š `Case i` ï¼Œæ‰€ä»¥å†æä¸€ä¸ªå˜é‡å°±å®Œäº‹äº†ï¼

```cpp
int idx = 1;  // æ­¤å¤„ idx å˜é‡å³ i å˜é‡
while(n != EOF)
{
    cin >> n;
    cout << "Case " << idx++ << ":" << endl;  // è¾“å‡º Case i å› ä¸º "++" åœ¨åæ˜¯å…ˆèµ‹å€¼å†è¿ç®—ï¼Œæ‰€ä»¥å¯ä»¥è¿™ä¹ˆå†™ï¼Œå°±ç›¸å½“äºå…ˆè¾“å‡º idx å½“å‰å€¼å†åŠ 
    memset(vis, false, sizeof(vis));
    vis[1] = true;
    arr[0] = 1;
    back(1);
}
```

### æœ€ç»ˆä»£ç 

```cpp
#include <bits/stdc++.h>
using namespace std;

const int MAXN = 16;
int n;
int arr[MAXN];
bool vis[MAXN];

// åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºç´ æ•°
bool check(int num)
{
    if (num < 2)
    {
        return false;
    }
    for (int i = 2; i * i <= num; i++)
    {
        if (num % i == 0)
        {
            return false;
        }
    }
    return true;
}

// å›æº¯
// curè¡¨ç¤ºå½“å‰ä½ç½®
void back(int cur)
{
    if (cur == n)  // æ£€æŸ¥æœ€åä¸€ä¸ªæ•°å­—å’Œç¬¬ä¸€ä¸ªæ•°å­—ä¹‹å’Œæ˜¯å¦ä¸ºç´ æ•°
    {
        if (check(arr[0] + arr[n - 1]))
        {
            for (int i = 0; i < n; i++)
            {
                cout << arr[i] << " ";
            }
            cout << endl;
        }
        return;
    }
    for (int i = 2; i <= n; i++)
    {
        if (!vis[i] && check(arr[cur - 1] + i))
        {
            vis[i] = true;
            arr[cur] = i;
            back(cur + 1);
            vis[i] = false;
        }
    }
}

int main()
{
    int idx = 1;
    while(n != EOF)
    {
        cin >> n;
        cout << "Case " << idx++ << ":" << endl;
        memset(vis, false, sizeof(vis));
        vis[1] = true;
        arr[0] = 1;
        back(1);
    }
    return 0;
}
```

## å†™åœ¨æœ€å

åˆ°è¿™é‡Œæœ¬ç‰‡é¢˜è§£å°±ç»“æŸäº†ï¼ŒUVAç‰ˆæœ¬æ²¡æäº¤ï¼Œå‰é¢è¯´äº†æ³¨å†Œä¸èµ·è´¦å·ï¼Œä½†æ˜¯ä»£ç åº”è¯¥æ²¡é—®é¢˜ï¼Œæœ‰é—®é¢˜è¯„è®ºå‘ŠçŸ¥ï¼Œè°¢è°¢æ”¯æŒğŸ™
